# 小程序

## 小程序开发概述

小程序是一种不需要下载安装即可使用的应用，触手可及、用完即走。国内主流的小程序平台包括微信小程序、支付宝小程序、抖音小程序等。其中微信小程序用户基数最大，是首选的开发平台。

小程序使用 Web 技术开发（HTML、CSS、JavaScript），但有其特定的开发框架和 API。对于 Vibe Coding 学习者来说，小程序是连接用户、创造价值的好渠道。

## 微信小程序基础

### 开发环境

开发微信小程序需要：微信开发者工具，用于创建、预览和发布小程序。微信公众平台账号，用于注册和管理小程序。

### 项目结构

```
miniprogram/
├── app.js              # 应用逻辑
├── app.json            # 应用配置
├── app.wxss            # 全局样式
├── pages/              # 页面目录
│   └── index/          # 首页
│       ├── index.js    # 页面逻辑
│       ├── index.json  # 页面配置
│       ├── index.wxml  # 页面结构
│       └── index.wxss  # 页面样式
├── components/         # 自定义组件
├── utils/              # 工具函数
└── static/             # 静态资源
```

### 核心概念

小程序的核心概念包括：页面，小程序的基本组成单位，每个页面有对应的四个文件。组件，小程序提供的 UI 组件，如 view、button、input 等。数据绑定，WXML 中的动态数据来自 JS 中的 data。事件处理，通过 bindtap 等属性绑定事件处理函数。

## 页面开发

### WXML 模板

WXML 是小程序的标记语言，语法类似 HTML：

```html
<view class="container">
  <text class="title">{{title}}</text>
  <button bindtap="handleTap">点击</button>
</view>
```

### WXSS 样式

WXSS 是小程序的样式语言，语法类似 CSS，支持大部分 CSS 特性：

```css
.container {
  padding: 20rpx;
  background: #fff;
}
.title {
  font-size: 32rpx;
  color: #333;
}
```

### JavaScript 逻辑

页面的 JS 文件负责处理数据和逻辑：

```javascript
Page({
  data: {
    title: 'Hello World'
  },
  handleTap() {
    this.setData({
      title: 'Clicked!'
    })
  }
})
```

### 页面生命周期

小程序页面有生命周期函数：onLoad 页面加载时触发。onShow 页面显示时触发。onReady 页面初次渲染完成时触发。onHide 页面隐藏时触发。onUnload 页面卸载时触发。

## 数据与网络

### 数据存储

小程序提供多种数据存储方式：wx.setStorage 本地存储。wx.setStorageSync 同步存储。wx.getStorage 获取存储。wx.getStorageSync 同步获取。

### 网络请求

使用 wx.request 发起网络请求：

```javascript
wx.request({
  url: 'https://api.example.com/data',
  method: 'GET',
  success(res) {
    console.log(res.data)
  }
})
```

### 云开发

微信提供云开发能力，无需服务器即可使用数据库和云函数：云数据库，类似 MongoDB 的数据库。云函数，在服务端运行的 Node.js 函数。云存储，文件存储服务。

## 组件开发

### 自定义组件

创建自定义组件，实现代码复用：

```json
// component.json
{
  "component": true
}
```

```javascript
// component.js
Component({
  properties: {
    title: { type: String, value: '' }
  },
  data: {},
  methods: {
    handleTap() {
      this.triggerEvent('click')
    }
  }
})
```

### 组件通信

父子组件之间可以通过：属性传递，父组件向子组件传递数据。事件，子组件向父组件发送通知。插槽，在组件中插入自定义内容。

## 实战项目：待办事项小程序

### 项目规划

创建一个待办事项管理小程序：用户可以添加新的待办事项。显示待办事项列表。标记事项为已完成或未完成。删除事项。支持本地存储和云端同步。

### 开发步骤

第一步，创建项目并配置页面。在 app.json 中配置页面路径和窗口样式。

第二步，实现首页 UI。设计任务列表、添加按钮、完成状态的显示。

第三步，实现添加功能。输入框和按钮的交互，数据更新和本地存储。

第四步，实现列表展示。循环渲染任务列表，区分已完成和未完成状态。

第五步，实现编辑和删除。点击完成切换状态，长按或滑动删除。

第六步，优化体验。添加动画效果、空状态提示、编辑功能。

### 对话示例

```
请帮我创建一个微信小程序待办事项应用。页面包含：
1. 一个输入框和一个添加按钮在顶部
2. 下方是一个列表，显示所有待办事项
3. 每个事项显示复选框、文本内容、删除按钮
4. 点击复选框切换完成状态，已完成的显示删除线
5. 所有数据存储在本地 storage 中
```

## 实战项目：天气查询小程序

### 项目规划

创建天气查询小程序：用户输入城市名称查询天气。显示当前天气状况。显示未来几天的天气预报。支持城市收藏和历史记录。

### 开发步骤

第一步，配置页面和获取用户位置。

第二步，实现天气 API 调用。使用和风天气或其他天气 API。

第三步，设计天气展示界面。当前天气和未来天气预报分开展示。

第四步，实现城市搜索和选择。

第五步，添加收藏和历史记录功能。

第六步，完善 UI 细节和加载状态。

## 小程序发布与运营

### 发布流程

小程序的发布流程：完成代码开发和测试。在微信开发者工具中上传代码。登录微信公众平台提交审核。审核通过后发布上线。

### 运营建议

小程序运营需要注意：提供有价值的功能，真正解决用户问题。优化用户体验，界面简洁、操作流畅。做好推广，利用社交关系链传播。持续迭代，根据用户反馈不断改进。

### 数据分析

微信提供数据分析能力：访问分析，了解用户访问情况。用户分析，了解用户画像。行为分析，了解用户使用习惯。

## 跨平台小程序开发

### Taro

Taro 是一个跨平台开发框架，可以使用 React 或 Vue 开发小程序。代码可以编译到多个平台（微信、支付宝、H5、RN 等）。

### Uni-app

Uni-app 是另一个跨平台框架，使用 Vue.js 开发。可以发布到多个小程序平台以及 H5 和 App。

对于需要同时开发多个平台小程序的场景，跨平台框架是更好的选择。
